Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 50
Rules claiming more threads will be scaled down.
Job stats:
job                    count
-------------------  -------
snv_clair3                 1
snv_clair3_vep             1
snv_deepvariant            1
snv_deepvariant_vep        1
snv_longshot               1
snv_longshot_vep           1
snv_nanocaller             1
snv_nanocaller_vep         1
sv_cutesv                  1
sv_cutesv_annotsv          1
sv_gasoline_annotsv        1
sv_germ_gasoline           1
sv_sniffles                1
sv_sniffles_annotsv        1
sv_svim                    1
sv_svim_annotsv            1
total                     16

Select jobs to execute...
Execute 8 jobs...

[Thu May 16 11:28:11 2024]
localrule sv_sniffles:
    input: /data2/utility/references/genomics/Homo_sapiens_assembly38.fasta, /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam, /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam.bai
    output: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_sniffles.vcf
    jobid: 3
    reason: Missing output files: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_sniffles.vcf
    wildcards: sample=testrun_4_HG002
    threads: 8
    resources: tmpdir=/tmp

sniffles       --input /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam --reference /data2/utility/references/genomics/Homo_sapiens_assembly38.fasta --vcf /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_sniffles.vcf --threads 8
Activating conda environment: sniffles2

[Thu May 16 11:28:12 2024]
localrule sv_cutesv:
    input: /data2/utility/references/genomics/Homo_sapiens_assembly38.fasta, /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam, /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam.bai, /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002
    output: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_cutesv.vcf
    jobid: 11
    reason: Missing output files: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_cutesv.vcf
    wildcards: sample=testrun_4_HG002
    threads: 8
    resources: tmpdir=/tmp

cuteSV -t 8        /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam /data2/utility/references/genomics/Homo_sapiens_assembly38.fasta /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_cutesv.vcf /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002
Activating conda environment: svim_cutesv

[Thu May 16 11:28:12 2024]
localrule snv_clair3:
    input: /data2/utility/references/genomics/Homo_sapiens_assembly38.fasta, /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam, /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam.bai
    output: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_clair3
    jobid: 13
    reason: Missing output files: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_clair3
    wildcards: sample=testrun_4_HG002
    threads: 8
    resources: tmpdir=/tmp

/data2/mbaragli/tools/Clair3/run_clair3.sh --bam_fn=/data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam --ref_fn=/data2/utility/references/genomics/Homo_sapiens_assembly38.fasta --output=/data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_clair3 --threads=8 --platform=ont --model_path /data2/mbaragli/tools/rerio/clair3_models/r1041_e82_400bps_sup_v430      
Activating conda environment: nano_clair3

[Thu May 16 11:28:12 2024]
localrule snv_deepvariant:
    input: /data2/utility/references/genomics/Homo_sapiens_assembly38.fasta, /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam, /data2/utility/references/genomics
    output: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_deepvariant
    jobid: 7
    reason: Missing output files: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_deepvariant
    wildcards: sample=testrun_4_HG002
    threads: 8
    resources: tmpdir=/tmp


        docker run         -v "/data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads":"/data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads"         -v "/data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_deepvariant":"/data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_deepvariant"         -v "/data2/utility/references/genomics":"/data2/utility/references/genomics"         kishwars/pepper_deepvariant:r0.8         run_pepper_margin_deepvariant call_variant         -b "/data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam"         -f "/data2/utility/references/genomics/Homo_sapiens_assembly38.fasta"         -o "/data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_deepvariant"         -t "8"                            --ont_r10_q20
        

[Thu May 16 11:28:12 2024]
localrule sv_svim:
    input: /data2/utility/references/genomics/Homo_sapiens_assembly38.fasta, /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam, /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam.bai
    output: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_svim
    jobid: 1
    reason: Missing output files: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_svim
    wildcards: sample=testrun_4_HG002
    resources: tmpdir=/tmp

svim alignment /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_svim /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam /data2/utility/references/genomics/Homo_sapiens_assembly38.fasta        
Activating conda environment: svim_cutesv

[Thu May 16 11:28:12 2024]
localrule snv_nanocaller:
    input: /data2/utility/references/genomics/Homo_sapiens_assembly38.fasta, /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam, /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam.bai
    output: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_nanocaller
    jobid: 5
    reason: Missing output files: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_nanocaller
    wildcards: sample=testrun_4_HG002
    threads: 8
    resources: tmpdir=/tmp

NanoCaller      --cpu 8  --bam /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam --ref /data2/utility/references/genomics/Homo_sapiens_assembly38.fasta --output /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_nanocaller
Activating conda environment: nano_clair3

[Thu May 16 11:28:12 2024]
localrule snv_longshot:
    input: /data2/utility/references/genomics/Homo_sapiens_assembly38.fasta, /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam, /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam.bai
    output: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_longshot.vcf
    jobid: 9
    reason: Missing output files: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_longshot.vcf
    wildcards: sample=testrun_4_HG002
    resources: tmpdir=/tmp

longshot        --bam /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam --ref /data2/utility/references/genomics/Homo_sapiens_assembly38.fasta --out /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_longshot.vcf
Activating conda environment: longshot2

[Thu May 16 11:28:12 2024]
localrule sv_germ_gasoline:
    input: /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam, /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002, /data2/utility/references/genomics/Homo_sapiens_assembly38.fasta
    output: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_gasoline/gasoline_final.vcf
    jobid: 15
    reason: Missing output files: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_gasoline/gasoline_final.vcf
    wildcards: sample=testrun_4_HG002
    threads: 8
    resources: tmpdir=/tmp


            cd /data2/abimbocci/GASOLINE_1.1/
            perl GASOLINEParse.pl -B /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam -L Germ -O /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_gasoline/germ -R hg38  
            perl GASOLINEGermlineDetector.pl -B /data2/mbaragli/python_app/app_python/work_dir/testrun_HG002/sorted_reads/testrun_HG002_sorted.bam -L Germ -O /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_gasoline/germ  -NT 8    
            perl GASOLINEGermlineVCFCreate.pl -L Germ -I /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_gasoline/germ -O /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_gasoline/gasoline_final.vcf -RA hg38 -FR /data2/utility/references/genomics/Homo_sapiens_assembly38.fasta    
            
[Thu May 16 11:32:40 2024]
Finished job 3.
1 of 16 steps (6%) done
Select jobs to execute...
Execute 1 jobs...

[Thu May 16 11:32:40 2024]
localrule sv_sniffles_annotsv:
    input: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_sniffles.vcf
    output: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_sniffles_annotsv.tsv
    jobid: 2
    reason: Missing output files: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_sniffles_annotsv.tsv; Input files updated by another job: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_sniffles.vcf
    wildcards: sample=testrun_4_HG002
    resources: tmpdir=/tmp

/data2/mbaragli/tools/annotSV/AnnotSV/bin/AnnotSV -genomeBuild GRCh37 -SVinputFile /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_sniffles.vcf -outputFile /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_sniffles_annotsv.tsv      -vcf 1 -svtBEDcol 1
[Thu May 16 11:34:46 2024]
Finished job 2.
2 of 16 steps (12%) done
Waiting at most 5 seconds for missing files.
MissingOutputException in rule sv_germ_gasoline in file /data2/mbaragli/python_app/app_python/Snakefile, line 466:
Job 15  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
/data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_gasoline/gasoline_final.vcf (missing locally, parent dir contents: germ)
[Thu May 16 12:00:28 2024]
Finished job 1.
3 of 16 steps (19%) done
Select jobs to execute...
Execute 1 jobs...

[Thu May 16 12:00:28 2024]
localrule sv_svim_annotsv:
    input: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_svim
    output: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_svim_annotsv.tsv
    jobid: 0
    reason: Missing output files: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_svim_annotsv.tsv; Input files updated by another job: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_svim
    wildcards: sample=testrun_4_HG002
    resources: tmpdir=/tmp

/data2/mbaragli/tools/annotSV/AnnotSV/bin/AnnotSV -genomeBuild GRCh37 -SVinputFile /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_svim/variants.vcf -outputFile /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_svim_annotsv.tsv      -vcf 1 -svtBEDcol 1
[Thu May 16 12:01:37 2024]
Finished job 13.
4 of 16 steps (25%) done
Select jobs to execute...
Execute 1 jobs...

[Thu May 16 12:01:37 2024]
localrule snv_clair3_vep:
    input: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_clair3
    output: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_clair3_vep.vcf
    jobid: 12
    reason: Missing output files: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_clair3_vep.vcf; Input files updated by another job: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_clair3
    wildcards: sample=testrun_4_HG002
    threads: 8
    resources: tmpdir=/tmp

vep -format vcf -i /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_clair3/merge_output.vcf.gz -o /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_clair3_vep.vcf --vcf --fork 8 --assembly GRCh37       --database --fork 30
Activating conda environment: vep
[Thu May 16 12:02:40 2024]
Error in rule snv_clair3_vep:
    jobid: 12
    input: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_clair3
    output: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_clair3_vep.vcf
    conda-env: vep
    shell:
        vep -format vcf -i /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_clair3/merge_output.vcf.gz -o /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_clair3_vep.vcf --vcf --fork 8 --assembly GRCh37       --database --fork 30
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

[Thu May 16 12:35:20 2024]
Finished job 0.
5 of 16 steps (31%) done
[Thu May 16 19:07:39 2024]
Finished job 11.
6 of 16 steps (38%) done
Select jobs to execute...
Execute 1 jobs...

[Thu May 16 19:07:39 2024]
localrule sv_cutesv_annotsv:
    input: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_cutesv.vcf
    output: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_cutesv_annotsv.tsv
    jobid: 10
    reason: Missing output files: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_cutesv_annotsv.tsv; Input files updated by another job: /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_cutesv.vcf
    wildcards: sample=testrun_4_HG002
    resources: tmpdir=/tmp

/data2/mbaragli/tools/annotSV/AnnotSV/bin/AnnotSV -genomeBuild GRCh37 -SVinputFile /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_cutesv.vcf -outputFile /data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/sv/testrun_4_HG002_cutesv_annotsv.tsv      -vcf 1 -svtBEDcol 1
[Thu May 16 19:08:51 2024]
Finished job 10.
7 of 16 steps (44%) done
Traceback (most recent call last):

  File "/data2/abimbocci/.conda/envs/snakemake/lib/python3.12/site-packages/snakemake/cli.py", line 2068, in args_to_api
    dag_api.execute_workflow(

  File "/data2/abimbocci/.conda/envs/snakemake/lib/python3.12/site-packages/snakemake/api.py", line 589, in execute_workflow
    workflow.execute(

  File "/data2/abimbocci/.conda/envs/snakemake/lib/python3.12/site-packages/snakemake/workflow.py", line 1247, in execute
    raise e

  File "/data2/abimbocci/.conda/envs/snakemake/lib/python3.12/site-packages/snakemake/workflow.py", line 1243, in execute
    success = self.scheduler.schedule()
              ^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/data2/abimbocci/.conda/envs/snakemake/lib/python3.12/site-packages/snakemake/scheduler.py", line 198, in schedule
    self._finish_jobs()

  File "/data2/abimbocci/.conda/envs/snakemake/lib/python3.12/site-packages/snakemake/scheduler.py", line 376, in _finish_jobs
    async_run(postprocess())

  File "/data2/abimbocci/.conda/envs/snakemake/lib/python3.12/site-packages/snakemake/common/__init__.py", line 94, in async_run
    return asyncio.run(coroutine)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "/data2/abimbocci/.conda/envs/snakemake/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^

  File "/data2/abimbocci/.conda/envs/snakemake/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/data2/abimbocci/.conda/envs/snakemake/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^

  File "/data2/abimbocci/.conda/envs/snakemake/lib/python3.12/site-packages/snakemake/scheduler.py", line 322, in postprocess
    await job.postprocess(

  File "/data2/abimbocci/.conda/envs/snakemake/lib/python3.12/site-packages/snakemake/jobs.py", line 1092, in postprocess
    await self.dag.check_and_touch_output(

  File "/data2/abimbocci/.conda/envs/snakemake/lib/python3.12/site-packages/snakemake/dag.py", line 684, in check_and_touch_output
    f.touch()

  File "/data2/abimbocci/.conda/envs/snakemake/lib/python3.12/site-packages/snakemake/io.py", line 699, in touch
    raise e

  File "/data2/abimbocci/.conda/envs/snakemake/lib/python3.12/site-packages/snakemake/io.py", line 685, in touch
    with open(file, "w"):
         ^^^^^^^^^^^^^^^

PermissionError: [Errno 13] Permission denied: '/data2/mbaragli/python_app/app_python/work_dir/testrun_4_HG002/snv/testrun_4_HG002_deepvariant/.snakemake_timestamp'

